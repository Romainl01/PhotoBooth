<!DOCTYPE html>
<html>
<head>
  <title>Test Supabase onAuthStateChange</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <h1>Testing Supabase onAuthStateChange behavior</h1>
  <p>Check the console...</p>

  <script>
    // Replace with your actual Supabase credentials
    const SUPABASE_URL = 'YOUR_SUPABASE_URL'
    const SUPABASE_ANON_KEY = 'YOUR_ANON_KEY'

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

    console.log('=== TEST START ===')
    console.log('Setting up onAuthStateChange listener...')

    // Does this fire immediately with current session?
    supabase.auth.onAuthStateChange((event, session) => {
      console.log('ðŸ”” onAuthStateChange fired!')
      console.log('Event:', event)
      console.log('Session exists:', !!session)
      console.log('User ID:', session?.user?.id)
    })

    console.log('Listener registered. Waiting to see if it fires...')

    // Also try getSession for comparison
    setTimeout(async () => {
      console.log('\n=== Trying getSession() for comparison ===')
      const { data } = await supabase.auth.getSession()
      console.log('getSession result:', !!data.session)
    }, 2000)
  </script>
</body>
</html>
